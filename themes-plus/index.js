(function(exports,plugin,metro,common,assets,toasts,ui,patcher,storage,components,utils,alerts){"use strict";var _findByProps$1,_findByProps1,_findByProps2;const ThemeStore$1=metro.findByStoreName("ThemeStore");metro.findByProps("triggerHaptic");const colorModule=metro.findByProps("colors","unsafe_rawColors"),colorResolver=colorModule?.internal??colorModule?.meta,TextStyleSheet=metro.findByProps("TextStyleSheet").TextStyleSheet,Navigator=metro.findByName("Navigator")??((_findByProps$1=metro.findByProps("Navigator"))===null||_findByProps$1===void 0?void 0:_findByProps$1.Navigator),modalCloseButton=((_findByProps1=metro.findByProps("getRenderCloseButton"))===null||_findByProps1===void 0?void 0:_findByProps1.getRenderCloseButton)??((_findByProps2=metro.findByProps("getHeaderCloseButton"))===null||_findByProps2===void 0?void 0:_findByProps2.getHeaderCloseButton),{popModal,pushModal}=metro.findByProps("popModal","pushModal");function resolveSemanticColor(color){let theme=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ThemeStore$1.theme;return colorResolver.resolveSemanticColor(theme,color)}function openModal(key,modal){const empty=Symbol("empty");if(!Navigator||!modalCloseButton)return toasts.showToast(`${[Navigator?empty:"Navigator",modalCloseButton?empty:"modalCloseButton"].filter(function(x){return x!==empty}).join(", ")} is missing! Please try reinstalling your client.`,assets.getAssetIDByName("Small"));pushModal({key,modal:{key,modal,animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}})}function androidifyColor(color){let alpha=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;const[_,r,g,b]=color.match(/#([A-F0-9]{2})([A-F0-9]{2})([A-F0-9]{2})/i);return(alpha&255)<<24|(parseInt(r,16)&255)<<16|(parseInt(g,16)&255)<<8|parseInt(b,16)&255}function fluxSubscribe(topic,callback){return common.FluxDispatcher.subscribe(topic,callback),function(){return common.FluxDispatcher.unsubscribe(topic,callback)}}metro.find(function(x){return x?.WebView&&!x.default}).WebView;const Svg=metro.findByProps("SvgXml");metro.findByProps("isJoi");const Reanimated=metro.findByProps("useSharedValue");metro.findByProps("FlashList").FlashList;const zustand={create:metro.findByName("create")};metro.findByProps("pickSingle","isCancel");const RNMMKVManager=common.ReactNative.NativeModules.MMKVManager,RNFileManager=common.ReactNative.NativeModules.DCDFileManager??common.ReactNative.NativeModules.RTNFileManager;common.ReactNative.NativeModules.BundleUpdaterManager,common.ReactNative.NativeModules.DCDSoundManager;const RNFSManager=common.ReactNative.NativeModules.RNFSManager,normalizeFilePath=function(path){return path.startsWith("file://")?path.slice(7):path},getOptions=function(encoding){if(typeof encoding=="string"){if(["utf8","ascii","base64"].includes(encoding))return{encoding};throw new Error(`Invalid encoding type "${String(encoding)}"`)}else return encoding||{encoding:"utf8"}},readFileGeneric=function(filepath,encoding,command){const options=getOptions(encoding);return command(normalizeFilePath(filepath)).then(function(b64){let contents;return options.encoding==="utf8"?contents=Buffer.from(b64,"base64").toString("utf8"):options.encoding==="ascii"?contents=Buffer.from(b64,"base64").toString("ascii"):options.encoding==="base64"&&(contents=b64),contents})},resolveWrite=function(filepath){let write={style:null,path:null};const constants2=RNFileManager.getConstants();if(filepath.startsWith(constants2.DocumentsDirPath))write={style:"documents",path:filepath.slice(constants2.DocumentsDirPath.length+1)};else if(filepath.startsWith(constants2.CacheDirPath))write={style:"cache",path:filepath.slice(constants2.CacheDirPath.length+1)};else throw new Error(`File path "${String(filepath)}" is unsupported on versions <211.6 (not a caches/documents path, missing RNFS)`);return write},RNFS={unlink(filepath){if(RNFSManager)return RNFSManager.unlink(normalizeFilePath(filepath)).then(function(){});const write=resolveWrite(filepath);return RNFileManager.removeFile(write.style,write.path).then(function(){})},exists(filepath){return RNFSManager?RNFSManager.exists(normalizeFilePath(filepath)):RNFileManager.fileExists(normalizeFilePath(filepath))},readFile(filepath,encoding){if(RNFSManager)return readFileGeneric(filepath,encoding,RNFSManager.readFile);{const options=getOptions(encoding);if(options.encoding==="ascii")throw new Error('Encoding type "ascii" is unsupported on versions <211.6 (missing RNFS)');return RNFileManager.readFile(filepath,options.encoding)}},writeFile(filepath,contents,encoding){const options=getOptions(encoding);if(!RNFSManager){if(options.encoding==="ascii")throw new Error('Encoding type "ascii" is unsupported on versions <211.6 (missing RNFS)');const write=resolveWrite(filepath);return RNFileManager.writeFile(write.style,write.path,contents,options.encoding).then(function(){})}let b64;return options.encoding==="utf8"?b64=Buffer.from(contents,"utf8").toString("base64"):options.encoding==="ascii"?b64=Buffer.from(contents,"ascii").toString("base64"):options.encoding==="base64"&&(b64=contents),RNFSManager.writeFile(normalizeFilePath(filepath),b64,options)},mkdir(filepath){if(!RNFSManager)throw new Error("Function 'mkdir' is unsupported on versions <211.6 (missing RNFS)");return RNFSManager.mkdir(normalizeFilePath(filepath),{}).then(function(){})},MainBundlePath:RNFSManager?.RNFSMainBundlePath,get CachesDirectoryPath(){return RNFSManager?.RNFSCachesDirectoryPath??RNFileManager.getConstants().CacheDirPath},ExternalCachesDirectoryPath:RNFSManager?.RNFSExternalCachesDirectoryPath,get DocumentDirectoryPath(){return RNFSManager?.RNFSDocumentDirectoryPath??RNFileManager.getConstants().DocumentsDirPath},DownloadDirectoryPath:RNFSManager?.RNFSDownloadDirectoryPath,ExternalDirectoryPath:RNFSManager?.RNFSExternalDirectoryPath,ExternalStorageDirectoryPath:RNFSManager?.RNFSExternalStorageDirectoryPath,TemporaryDirectoryPath:RNFSManager?.RNFSTemporaryDirectoryPath,LibraryDirectoryPath:RNFSManager?.RNFSLibraryDirectoryPath,PicturesDirectoryPath:RNFSManager?.RNFSPicturesDirectoryPath,FileProtectionKeys:RNFSManager?.RNFSFileProtectionKeys,RoamingDirectoryPath:RNFSManager?.RNFSRoamingDirectoryPath,hasRNFS:!!RNFSManager};function createJSONStorage(getStorage,options){let storage2;try{storage2=getStorage()}catch{return}return{getItem:function(name){var _a;const parse=function(str2){return str2===null?null:JSON.parse(str2,void 0)},str=(_a=storage2.getItem(name))!=null?_a:null;return str instanceof Promise?str.then(parse):parse(str)},setItem:function(name,newValue){return storage2.setItem(name,JSON.stringify(newValue,void 0))},removeItem:function(name){return storage2.removeItem(name)}}}const toThenable=function(fn){return function(input){try{const result=fn(input);return result instanceof Promise?result:{then(onFulfilled){return toThenable(onFulfilled)(result)},catch(_onRejected){return this}}}catch(e){return{then(_onFulfilled){return this},catch(onRejected){return toThenable(onRejected)(e)}}}}},oldImpl=function(config,baseOptions){return function(set,get,api){let options={getStorage:function(){return localStorage},serialize:JSON.stringify,deserialize:JSON.parse,partialize:function(state2){return state2},version:0,merge:function(persistedState,currentState){return{...currentState,...persistedState}},...baseOptions},hasHydrated=!1;const hydrationListeners=new Set,finishHydrationListeners=new Set;let storage2;try{storage2=options.getStorage()}catch{}if(!storage2)return config(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];console.warn(`[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`),set(...args)},get,api);const thenableSerialize=toThenable(options.serialize),setItem=function(){const state2=options.partialize({...get()});let errorInSync;const thenable=thenableSerialize({state:state2,version:options.version}).then(function(serializedValue){return storage2.setItem(options.name,serializedValue)}).catch(function(e){errorInSync=e});if(errorInSync)throw errorInSync;return thenable},savedSetState=api.setState;api.setState=function(state2,replace){savedSetState(state2,replace),setItem()};const configResult=config(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];set(...args),setItem()},get,api);let stateFromStorage;const hydrate=function(){var _a;if(!storage2)return;hasHydrated=!1,hydrationListeners.forEach(function(cb){return cb(get())});const postRehydrationCallback=((_a=options.onRehydrateStorage)==null?void 0:_a.call(options,get()))||void 0;return toThenable(storage2.getItem.bind(storage2))(options.name).then(function(storageValue){if(storageValue)return options.deserialize(storageValue)}).then(function(deserializedStorageValue){if(deserializedStorageValue)if(typeof deserializedStorageValue.version=="number"&&deserializedStorageValue.version!==options.version){if(options.migrate)return options.migrate(deserializedStorageValue.state,deserializedStorageValue.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return deserializedStorageValue.state}).then(function(migratedState){var _a2;return stateFromStorage=options.merge(migratedState,(_a2=get())!=null?_a2:configResult),set(stateFromStorage,!0),setItem()}).then(function(){postRehydrationCallback?.(stateFromStorage,void 0),hasHydrated=!0,finishHydrationListeners.forEach(function(cb){return cb(stateFromStorage)})}).catch(function(e){postRehydrationCallback?.(void 0,e)})};return api.persist={setOptions:function(newOptions){options={...options,...newOptions},newOptions.getStorage&&(storage2=newOptions.getStorage())},clearStorage:function(){storage2?.removeItem(options.name)},getOptions:function(){return options},rehydrate:function(){return hydrate()},hasHydrated:function(){return hasHydrated},onHydrate:function(cb){return hydrationListeners.add(cb),function(){hydrationListeners.delete(cb)}},onFinishHydration:function(cb){return finishHydrationListeners.add(cb),function(){finishHydrationListeners.delete(cb)}}},hydrate(),stateFromStorage||configResult}},newImpl=function(config,baseOptions){return function(set,get,api){let options={storage:createJSONStorage(function(){return localStorage}),partialize:function(state2){return state2},version:0,merge:function(persistedState,currentState){return{...currentState,...persistedState}},...baseOptions},hasHydrated=!1;const hydrationListeners=new Set,finishHydrationListeners=new Set;let storage2=options.storage;if(!storage2)return config(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];console.warn(`[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`),set(...args)},get,api);const setItem=function(){const state2=options.partialize({...get()});return storage2.setItem(options.name,{state:state2,version:options.version})},savedSetState=api.setState;api.setState=function(state2,replace){savedSetState(state2,replace),setItem()};const configResult=config(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];set(...args),setItem()},get,api);api.getInitialState=function(){return configResult};let stateFromStorage;const hydrate=function(){var _a,_b;if(!storage2)return;hasHydrated=!1,hydrationListeners.forEach(function(cb){var _a2;return cb((_a2=get())!=null?_a2:configResult)});const postRehydrationCallback=((_b=options.onRehydrateStorage)==null?void 0:_b.call(options,(_a=get())!=null?_a:configResult))||void 0;return toThenable(storage2.getItem.bind(storage2))(options.name).then(function(deserializedStorageValue){if(deserializedStorageValue)if(typeof deserializedStorageValue.version=="number"&&deserializedStorageValue.version!==options.version){if(options.migrate)return options.migrate(deserializedStorageValue.state,deserializedStorageValue.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return deserializedStorageValue.state}).then(function(migratedState){var _a2;return stateFromStorage=options.merge(migratedState,(_a2=get())!=null?_a2:configResult),set(stateFromStorage,!0),setItem()}).then(function(){postRehydrationCallback?.(stateFromStorage,void 0),stateFromStorage=get(),hasHydrated=!0,finishHydrationListeners.forEach(function(cb){return cb(stateFromStorage)})}).catch(function(e){postRehydrationCallback?.(void 0,e)})};return api.persist={setOptions:function(newOptions){options={...options,...newOptions},newOptions.storage&&(storage2=newOptions.storage)},clearStorage:function(){storage2?.removeItem(options.name)},getOptions:function(){return options},rehydrate:function(){return hydrate()},hasHydrated:function(){return hasHydrated},onHydrate:function(cb){return hydrationListeners.add(cb),function(){hydrationListeners.delete(cb)}},onFinishHydration:function(cb){return finishHydrationListeners.add(cb),function(){finishHydrationListeners.delete(cb)}}},options.skipHydration||hydrate(),stateFromStorage||configResult}},persist=function(config,baseOptions){return"getStorage"in baseOptions||"serialize"in baseOptions||"deserialize"in baseOptions?(console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(config,baseOptions)):newImpl(config,baseOptions)};var constants$1={github:{url:"https://github.com/nexpid/BunnyPlugins/",raw:"https://raw.githubusercontent.com/nexpid/BunnyPlugins/main/"}};const useLangStore=zustand.create(persist(function(set,get){return{values:{},lastModified:null,update:async function(plugin2){const res=await fetch(`${constants$1.github.raw}lang/values/${plugin2}.json`,{headers:{"if-modified-since":get().lastModified}});if(!res.ok)return;const values=await res.json();set({lastModified:res.headers.get("last-modified"),values})}}},{name:"nexpid-lang",storage:createJSONStorage(function(){return RNMMKVManager}),partialize:function(state2){return{values:state2.values,lastModified:state2.lastModified}},onRehydrateStorage:function(){return function(){return RNMMKVManager.removeItem("nexpid-lang")}}}));var define_DEFAULT_LANG_default2={"plugin.name":"Themes+","settings.header":"Themes+ is **{active, select, true {active} false {inactive} other {}}**","settings.reload":"Reload","settings.inactive.no_theme":"No theme is selected","settings.inactive.themes_plus_unsupported":"The selected theme doesn't support Themes+","settings.inactive.no_iconpacks_list":"Couldn't fetch list of iconpacks","settings.inactive.no_iconpack_config":"Couldn't fetch selected iconpack config","settings.inactive.no_iconpack_files":"Couldn't fetch selected iconpack files","settings.patch.icons":"Custom icon colors","settings.patch.custom_icon_overlays":"Custom icon overlays","settings.patch.mention_line_color":"Custom message mention line color","settings.patch.iconpack":"Custom iconpack","sheet.iconpack_info.authors":"Authors","sheet.iconpack_info.source":"Source","modal.config.title":"Configuration","modal.config.iconpack.title":"Iconpack","modal.config.iconpack.mode":"Mode","modal.config.iconpack.mode.automatic":"Automatic","modal.config.iconpack.mode.automatic.desc":"Iconpack chosen by your current theme","modal.config.iconpack.mode.manual":"Manual","modal.config.iconpack.mode.manual.desc":"Choose an iconpack manually","modal.config.iconpack.mode.disabled":"Disabled","modal.config.iconpack.mode.disabled.desc":"Use Discord's default icons","modal.config.iconpack.choose":"Iconpack","modal.config.iconpack.choose.custom":"Custom","modal.config.iconpack.custom.url":"URL","modal.config.iconpack.custom.url.desc":"The main URL where all icons are located","modal.config.iconpack.custom.suffix":"Filename Suffix","modal.config.iconpack.custom.suffix.desc":"Appends a string after the icon name for compability with iOs based iconpacks. **Avoid** using this in new iconpacks.","modal.config.iconpack.custom.config.bigger_status":"Bigger status icons","modal.config.iconpack.custom.config.bigger_status.desc":"Makes status icons a bit bigger for compability. **Avoid** using this in new iconpacks.","modal.config.iconpack.custom.preview":"Preview icon","alert.downloadpack.title":"Download iconpack","alert.downloadpack.body":"Are you sure you want to download **{iconpack}**? This will take up **{space}**.","alert.downloadpack.confirm":"Download","alert.downloadpack.cancel":"Cancel","alert.downloadpack.dontshowagain_toggle":"Don't show again"};function _class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _create_class(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const IntlMessageFormat=metro.findByName("MessageFormat");RNFS.exists(`${RNFS.DocumentDirectoryPath}/vendetta/NexpidLang`).then(function(yes){return yes&&RNFS.unlink(`${RNFS.DocumentDirectoryPath}/vendetta/NexpidLang`)});let Lang=function(){function Lang2(plugin2){var _this=this;_class_call_check(this,Lang2),_define_property(this,"plugin",void 0),_define_property(this,"_unload",void 0),_define_property(this,"Values",void 0),this.plugin=plugin2,useLangStore.persist.setOptions({name:`nexpid-lang-${plugin2}`,onRehydrateStorage:function(){return function(state2){return state2.update(_this.plugin)}}}),useLangStore.persist.rehydrate(),this._unload=fluxSubscribe("I18N_LOAD_SUCCESS",function(){return useLangStore.persist.rehydrate()})}return _create_class(Lang2,[{key:"unload",value:function(){var _this__unload,_this;(_this__unload=(_this=this)._unload)===null||_this__unload===void 0||_this__unload.call(_this)}},{key:"format",value:function(_key,input){var _values_locale,_values_en,_DEFAULT_LANG;const key=_key,locale=Lang2.getLang(),values=useLangStore.getState().values;if(!values)return String(key);const val=((_values_locale=values[locale])===null||_values_locale===void 0?void 0:_values_locale[key])??((_values_en=values.en)===null||_values_en===void 0?void 0:_values_en[key])??((_DEFAULT_LANG=define_DEFAULT_LANG_default2)===null||_DEFAULT_LANG===void 0?void 0:_DEFAULT_LANG[key]);return val?Object.keys(input).length>0?new IntlMessageFormat(val).format(input):val:String(key)}}],[{key:"getLang",value:function(){var _i18n_getLocale;const lang2=((_i18n_getLocale=common.i18n.getLocale())===null||_i18n_getLocale===void 0?void 0:_i18n_getLocale.replace(/-/g,"_"))??"en";return lang2.startsWith("en_")?"en":lang2}},{key:"basicFormat",value:function(text){const rules=[{regex:/\*\*(.*?)\*\*/g,react:function(txt2){return React.createElement(common.ReactNative.Text,{style:{fontWeight:"900"}},txt2)}}],txt=text.split("");let off=0;for(const rule of rules){const matches=Array.from(text.matchAll(rule.regex));for(const match of matches)match[1]&&(txt.splice(match.index-off,match[0].length,rule.react(match[1])),off+=match[0].length-1)}return txt}}]),Lang2}();function Text(param){let{variant,lineClamp,color,align,style,onPress,getChildren,children,liveUpdate}=param;const[_,forceUpdate]=common.React.useReducer(function(x){return~x},0);return common.React.useEffect(function(){if(!liveUpdate)return;const nextSecond=new Date().setMilliseconds(1e3);let interval;const timeout=setTimeout(function(){forceUpdate(),interval=setInterval(forceUpdate,1e3)},nextSecond-Date.now());return function(){clearTimeout(timeout),clearInterval(interval)}},[]),common.React.createElement(common.ReactNative.Text,{style:[variant?TextStyleSheet[variant]:{},color?{color:resolveSemanticColor(ui.semanticColors[color])}:{},align?{textAlign:align}:{},style??{}],numberOfLines:lineClamp,onPress},getChildren?.()??children)}const NotFound=function(prop,isFunction){return function(){return common.React.useEffect(function(){toasts.showToast(`${prop} not found! Search for PNF in Debug Logs!`),console.warn(`!! PNF ERROR !!
Missing the redesign ${isFunction?"function":"component"}: ${prop}. Please bug @nexpid about this on Discord!`)},[]),null}},findProp=function(){for(var _len=arguments.length,props=new Array(_len),_key=0;_key<_len;_key++)props[_key]=arguments[_key];var _findByProps3;return(_findByProps3=metro.findByProps(...props))===null||_findByProps3===void 0?void 0:_findByProps3[props[0]]},findPropPolyfill=function(isFunction){for(var _len=arguments.length,props=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)props[_key-1]=arguments[_key];return findProp(...props)??NotFound(props[0],isFunction)};function buttonVariantPolyfill(){return"REDESIGN_BUTTON_ACTIVE_TEXT"in ui.semanticColors?{active:"active",destructive:"destructive"}:{active:"positive",destructive:"danger"}}const _PressableScale=findProp("PressableScale");findProp("Slider");const Button=findPropPolyfill(!1,"Button"),RowButton=findPropPolyfill(!1,"RowButton"),FloatingActionButton=findPropPolyfill(!1,"FloatingActionButton");_PressableScale??common.ReactNative.Pressable;const IconButton=findPropPolyfill(!1,"IconButton"),TextInput=findPropPolyfill(!1,"TextInput"),Tabs=findPropPolyfill(!1,"Tabs"),SegmentedControlPages=findPropPolyfill(!1,"SegmentedControlPages");findPropPolyfill(!1,"Card"),findPropPolyfill(!1,"Stack");const useSegmentedControlState=findPropPolyfill(!0,"useSegmentedControlState"),state={loading:!0,active:!1,iconpack:{iconpack:null,list:[],hashes:{}},patches:[],inactive:[]};let stateUsers=new Array;function useState(){const[_,forceUpdate]=common.React.useReducer(function(x){return~x},0);common.React.useEffect(function(){const func=function(){return forceUpdate()};return stateUsers.push(func),function(){stateUsers=stateUsers.filter(function(x){return x!==func})}},[])}function updateState(){stateUsers.forEach(function(x){return x()})}var check="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFbSURBVHhe7dfhTcMwEIbhjNAROgFiAlZgBNiAERilGzACIzACI7CC+Y7coUq4qU36x773kawqqRvlXlVVugAAAAAAAAAAANxEKeXVlh/inMcJL34aRkHO44Rnfzs3hajFCbkjKcBWnJAzkgZviRNyRdLAPXHMo390fhr2aZ25WZ5vj4YlziUaljiXaNjeOOM9KOqmj1ofWvd+qon232n1GO+vhm7a4nz+3H4pX1pNkbTP4tj+VsPHCTb00bdU6f20cYKdr0bS+fRxwp9Idqw1fZyD1rU44TeSvfpxq/HiBN38aZ2hiUV58NdW48YJGqInUo/x4wQNc+tIJ7/0PDTU+zrbbvPFMRrMfrTtKXqPOeMEDbgn0ptfZm4a9D+RbP/BLzE/G9aHbpErTtDQLQ+EOeMEDb8VKXecoAi1SHa8+U8/FYvhUQxxaiyKlj1MEgcAAAAAAAAAAFyzLN9AUkswJG5BbwAAAABJRU5ErkJggg==";const ThemeStore=metro.findByStoreName("ThemeStore");function matchTheme(colors){const theme=ThemeStore.theme;return theme in colors?colors[theme]:["dark","midnight"].includes(theme)?colors.darker:colors.light}function resolveColor(color){if(Array.isArray(color))return matchTheme({darker:color[0],light:color[1],midnight:color[2]});if(color.startsWith("SC_"))return ui.semanticColors[color.slice(3)]?resolveSemanticColor(ui.semanticColors[color.slice(3)]):"#ffffff";if(color.startsWith("RC_"))return ui.rawColors[color.slice(3)]??"#ffffff";if(color.startsWith("#")&&color.length===4)return`#${color[1].repeat(2)}${color[2].repeat(2)}${color[3].repeat(2)}`;if(color.startsWith("#")&&color.length===7)return color}function getIconTint(plus,icon,customName){var _getAssetByID;const name=customName??((_getAssetByID=assets.getAssetByID(icon))===null||_getAssetByID===void 0?void 0:_getAssetByID.name);if(name&&plus.icons[name])return resolveColor(plus.icons[name])}function asIcon(plus,customName,img){if(typeof img.props.source=="number"){const clr=getIconTint(plus,img.props.source,customName);clr&&(img.props.style=[img.props.style,{tintColor:clr}])}return img.props.ignore=!0,img}function getIconOverlay(plus,icon,style){var _getAssetByID;const ic=(_getAssetByID=assets.getAssetByID(icon))===null||_getAssetByID===void 0?void 0:_getAssetByID.name;if(ic){if(["ic_radio_circle_checked","ic_radio_square_checked_24px","ic_selection_checked_24px"].includes(ic))return{style:{tintColor:"#5865F2"},children:React.createElement(common.ReactNative.View,{style:{position:"absolute",left:0,top:0}},asIcon(plus,`${ic}__overlay`,React.createElement(common.ReactNative.Image,{source:{uri:check},style:[style,{tintColor:"#FFF"}]})))};if(["app_installed_check","ic_radio_circle_checked_green"].includes(ic))return{style:{tintColor:"#3BA55C"},children:React.createElement(common.ReactNative.View,{style:{position:"absolute",left:0,top:0}},asIcon(plus,`${ic}__overlay`,React.createElement(common.ReactNative.Image,{source:{uri:check},style:[style,{tintColor:"#FFF"}]})))}}}var constants={iconpacks:{list:"https://raw.githubusercontent.com/nexpid/ThemesPlus/main/iconpacks/list.json",assets:"https://raw.githubusercontent.com/nexpid/ThemesPlus/main/iconpacks/assets/",tree:function(iconpack){return`https://raw.githubusercontent.com/nexpid/ThemesPlus/iconpack-trees/${iconpack}.txt`},hashes:"https://raw.githubusercontent.com/nexpid/ThemesPlus/iconpack-trees/_hashes.txt"}};const useCacheStore=zustand.create(persist(function(set,get){return{cache:{},isCached:function(link){return!!get().cache[link]},writeCache:function(link,data){return set({cache:{...get().cache,[link]:JSON.stringify(data)}})},readCache:function(link){return get().cache[link]?JSON.parse(get().cache[link]):null}}},{name:"themes-plus-cache",storage:createJSONStorage(function(){return RNMMKVManager}),partialize:function(state2){return{cache:state2.cache}}}));function customUrl(){const url=vstorage.iconpack.custom.url;return url.length>1&&(url.endsWith("/")?url:`${url}/`)}function flattenFilePath(path){return path.replace(/[\\/]/g,"_").replace(/-/g,"")}async function cFetch(url,init){let format=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"text";const cache=useCacheStore.getState(),rawUrl=typeof url=="string"?url:url.url,res=await fetch(url,init);let ret;if(res.status!==200)if(cache.isCached(rawUrl))ret=cache.readCache(rawUrl);else throw new Error(`Failed to fetch ${url}`);else ret=await res.text(),cache.writeCache(rawUrl,ret);return format==="json"?JSON.parse(ret):ret}function formatBytes(bytes){const sizes=["B","KB","MB","GB","TB"];if(bytes===0)return"0 B";const i=Math.floor(Math.log(bytes)/Math.log(1024));return`${(bytes/Math.pow(1024,i)).toFixed(2)} ${sizes[i]}`}async function getIconpackData(id,configUrl){const treeUrl=constants.iconpacks.tree(id),[config,tree]=await Promise.allSettled([configUrl?cFetch(configUrl,null,"json"):async function(){return Symbol()}(),cFetch(treeUrl).then(function(x){return x.replaceAll("\r","").split(`
`)})]);return{config:config.status==="fulfilled"&&typeof config.value!="symbol"?config.value:null,tree:tree.status==="fulfilled"?tree.value:null}}const iconsPath=`${RNFS.DocumentDirectoryPath}/pyoncord/downloads/themesplus/`;async function isPackInstalled(pack){var _state_iconpack_hashes_pack_id;if(await RNFS.exists(`${iconsPath}${pack.id}`)&&await RNFS.exists(`${iconsPath}${pack.id}.hash`)&&!((_state_iconpack_hashes_pack_id=state.iconpack.hashes[pack.id])===null||_state_iconpack_hashes_pack_id===void 0)&&_state_iconpack_hashes_pack_id.hash){const hash=await RNFS.readFile(`${iconsPath}${pack.id}.hash`,"utf8");return state.iconpack.hashes[pack.id].hash===hash?!0:"outdated"}else return!1}async function installIconpack(pack,signal,progress){var _state_iconpack_hashes_pack_id;const hash=(_state_iconpack_hashes_pack_id=state.iconpack.hashes[pack.id])===null||_state_iconpack_hashes_pack_id===void 0?void 0:_state_iconpack_hashes_pack_id.hash;if(!hash)throw new Error("Iconpack is not hashed");const{tree}=await getIconpackData(pack.id);if(!tree)throw new Error("Failed to get iconpack tree");RNFS.hasRNFS&&await RNFS.mkdir(`${iconsPath}${pack.id}`),await RNFS.writeFile(`${iconsPath}${pack.id}.hash`,hash);const shouldDownload=Object.values(assets.all).map(function(asset){return[...asset.httpServerLocation.split("/").slice(2),`${asset.name}${pack.suffix}.${asset.type}`].join("/")}),toDownload=tree.filter(function(file){return shouldDownload.includes(file)}).map(function(file){return[`${pack.load}/${file}`,`${iconsPath}${pack.id}/${flattenFilePath(file)}`,file]});let incr=0;const threadify=async function(arr){for(const[from,to,raw]of arr){if(signal?.aborted)throw new Error("Aborted");const blob=await fetch(from,{signal}).then(function(x){return x.blob()}),result=await function(){return new Promise(function(res,rej){const reader=new FileReader;reader.addEventListener("error",function(){return rej(new Error(`Failed to get blob of ${raw}`))}),reader.addEventListener("load",function(){return res(reader.result.toString())}),signal?.addEventListener("abort",function(){return reader.abort()}),reader.readAsDataURL(blob)})}();if(signal?.aborted)throw new Error("Aborted");const index2=result.indexOf(";base64,");if(index2===-1)throw new Error(`Failed to get base64 of ${raw}`);const data=result.slice(index2+8);if(await RNFS.writeFile(to,data,"base64"),incr++,signal?.aborted)throw new Error("Aborted");progress(incr/toDownload.length)}};await Promise.all(new Array(10).fill(0).map(function(_,i,a){const quart=toDownload.length/a.length;return threadify(toDownload.slice(Math.floor(i*quart),Math.floor((i+1)*quart)))}))}async function uninstallIconpack(pack){await RNFS.unlink(`${iconsPath}${pack.id}`),await RNFS.unlink(`${iconsPath}${pack.id}.hash`)}const Status=metro.findByName("Status",!1);function patchIcons(plus,tree,config){const{iconpack}=state.iconpack;config.biggerStatus&&patches.push(patcher.before("default",Status,function(args){var _a;const c=[...args],sizes=Object.values(Status.StatusSizes);return c[0].size=sizes[sizes.findIndex(function(x){return c[0].size===x})+1],(_a=c[0]).size??(_a.size=Status.StatusSizes.XLARGE),c}));let isInstalled=!1;isPackInstalled(iconpack).then(function(x){return isInstalled=!!x}),(plus.icons||plus.customOverlays||iconpack)&&(plus.icons&&state.patches.push(exports.PatchType.Icons),plus.customOverlays&&state.patches.push(exports.PatchType.CustomIconOverlays),iconpack&&state.patches.push(exports.PatchType.Iconpack),patches.push(patcher.instead("render",common.ReactNative.Image,function(_args,orig){const args=_args.slice(),[x]=args;if(typeof x.source!="number"||x.ignore)return orig(...args);const source=x.source,asset=assets.getAssetByID(source);if(!asset?.httpServerLocation)return orig(...args);const assetIconpackLocation=iconpack&&[...asset.httpServerLocation.split("/").slice(2),`${asset.name}${iconpack.suffix}.${asset.type}`].join("/"),useIconpack=iconpack&&(tree.length?tree.includes(assetIconpackLocation):!0);let overlay;if(plus.customOverlays&&!useIconpack&&(overlay=getIconOverlay(plus,source,x.style),overlay&&(overlay.replace&&(x.source=assets.getAssetIDByName(overlay.replace)),overlay.style&&(x.style=[x.style,overlay.style]))),plus.icons){const tint=getIconTint(plus,source);tint&&(x.style=[x.style,{tintColor:tint}])}useIconpack&&(x.source={uri:isInstalled?`file://${iconsPath}${iconpack.id}/${flattenFilePath(assetIconpackLocation)}`:iconpack.load+assetIconpackLocation,headers:{"cache-contorl":"public, max-age=3600"}});const ret=orig(...args);return overlay?.children?common.React.createElement(common.ReactNative.View,null,ret,overlay.children):ret})))}const RowGeneratorUtils=metro.findByProps("createBackgroundHighlight");function patchMentionLineColors(plus){plus.mentionLineColor&&(state.patches.push(exports.PatchType.MentionLineColor),patches.push(patcher.after("createBackgroundHighlight",RowGeneratorUtils,function(param,ret){let[x]=param;var _x_message;const clr=resolveColor(plus.mentionLineColor);!(x==null||(_x_message=x.message)===null||_x_message===void 0)&&_x_message.mentioned&&clr&&(ret.gutterColor=androidifyColor(clr,200))})))}const UserStore=metro.findByStoreName("UserStore"),patches=new Array;async function load(){var _selectedTheme_data;const bunny=window.bunny;patches.forEach(function(x){return x()}),patches.length=0,state.loading=!0,state.active=!1,state.iconpack={iconpack:null,list:[],hashes:{}},state.patches=[],state.inactive=[],updateState();try{state.iconpack={iconpack:null,list:await cFetch(constants.iconpacks.list,null,"json").then(function(res){return res.list}),hashes:await cFetch(constants.iconpacks.hashes,null,"json")}}catch{if(!state.iconpack.list.length||!Object.keys(state.iconpack.hashes).length)return state.loading=!1,state.inactive.push(exports.InactiveReason.NoIconpacksList),updateState()}let selectedTheme=Object.values(bunny.managers.themes.themes).find(function(x){return x.selected});if(!selectedTheme&&vstorage.iconpack.mode===exports.ConfigIconpackMode.Manual)selectedTheme={data:{plus:{version:0}}};else if(!selectedTheme)return state.loading=!1,state.inactive.push(exports.InactiveReason.NoTheme),updateState();const plusData=(_selectedTheme_data=selectedTheme.data)===null||_selectedTheme_data===void 0?void 0:_selectedTheme_data.plus;if(!plusData)return state.loading=!1,state.inactive.push(exports.InactiveReason.ThemesPlusUnsupported),updateState();const useIconpack=vstorage.iconpack.mode===exports.ConfigIconpackMode.Automatic?plusData.iconpack:vstorage.iconpack.mode===exports.ConfigIconpackMode.Manual?vstorage.iconpack.pack:void 0,isCustomIconpack=vstorage.iconpack.isCustom,user=UserStore.getCurrentUser();state.iconpack.iconpack=isCustomIconpack?{id:"custom-iconpack",name:"Custom iconpack",description:"A custom iconpack, created by you!",credits:{authors:[{name:user.username,id:user.id}],sources:["N/A"]},config:null,suffix:vstorage.iconpack.custom.suffix,load:customUrl()}:state.iconpack.list.find(function(x){return useIconpack===x.id});let iconpackConfig={biggerStatus:!1},tree=[];if(!isCustomIconpack&&state.iconpack.iconpack){let dt;try{dt=await getIconpackData(state.iconpack.iconpack.id,state.iconpack.iconpack.config)}catch{dt={config:null,tree:null}}if(dt.tree===null)return state.loading=!1,dt.config===null&&state.inactive.push(exports.InactiveReason.NoIconpackConfig),dt.tree===null&&state.inactive.push(exports.InactiveReason.NoIconpackFiles),updateState();tree=dt.tree,dt.config&&(iconpackConfig=dt.config)}else isCustomIconpack&&(iconpackConfig.biggerStatus=vstorage.iconpack.custom.config.biggerStatus);exports.enabled&&(state.active=!0,state.loading=!1,patchIcons(plusData,tree,iconpackConfig),patchMentionLineColors(plusData),updateState())}var _findByProps;const _ActionSheet=((_findByProps=metro.findByProps("ActionSheet"))===null||_findByProps===void 0?void 0:_findByProps.ActionSheet)??metro.find(function(x){var _x_render;return((_x_render=x.render)===null||_x_render===void 0?void 0:_x_render.name)==="ActionSheet"}),{ActionSheetTitleHeader,ActionSheetCloseButton}=metro.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton"),LazyActionSheet=metro.findByProps("openLazy","hideActionSheet"),{openLazy,hideActionSheet}=LazyActionSheet;metro.findByProps("showSimpleActionSheet");const ActionSheet=function(param){let{title,onClose,children}=param;return React.createElement(_ActionSheet,null,React.createElement(ActionSheetTitleHeader,{title,trailing:React.createElement(ActionSheetCloseButton,{onPress:onClose??function(){return hideActionSheet()}})}),children)};ActionSheet.open=function(sheet,props){openLazy(new Promise(function(res){return res({default:sheet})}),"ActionSheet",props)};function BetterTableRowTitle(param){let{title,onPress,icon,padding}=param;const styles=common.stylesheet.createThemedStyleSheet({androidRipple:{color:ui.semanticColors.ANDROID_RIPPLE,cornerRadius:4},icon:{width:16,height:16,marginTop:1.5,tintColor:ui.semanticColors.TEXT_MUTED}}),UseCompontent=onPress?common.ReactNative.Pressable:common.ReactNative.View;return React.createElement(UseCompontent,{android_ripple:styles.androidRipple,onPress,style:{marginBottom:8,marginHorizontal:padding?16:0,marginTop:padding?8:0,gap:4,flexDirection:"row",alignItems:"center"}},icon&&React.createElement(common.ReactNative.Image,{style:styles.icon,source:icon,resizeMode:"cover"}),React.createElement(Text,{variant:"text-sm/semibold",color:"TEXT_MUTED"},title))}function BetterTableRowGroup(param){let{title,onTitlePress,icon,children,padding,nearby}=param;const styles=common.stylesheet.createThemedStyleSheet({main:{backgroundColor:ui.semanticColors.CARD_PRIMARY_BG,borderColor:ui.semanticColors.BORDER_FAINT,borderWidth:1,borderRadius:16,overflow:"hidden",flex:1}});return React.createElement(common.ReactNative.View,{style:{marginHorizontal:16,marginTop:nearby?8:16}},title?typeof title=="string"?React.createElement(BetterTableRowTitle,{title,onPress:onTitlePress,icon}):title:null,React.createElement(common.ReactNative.View,{style:styles.main},padding?React.createElement(common.ReactNative.View,{style:{paddingHorizontal:16,paddingVertical:16}},children):children))}function Modal(props){return!Navigator||!modalCloseButton?null:React.createElement(Navigator,{initialRouteName:props.mkey,screens:{[props.mkey]:Object.assign(utils.without(props,"mkey","children"),{headerLeft:modalCloseButton?.(function(){return popModal(props.mkey)}),render:function(){return props.children}})}})}const{FormRow:FormRow$2}=components.Forms;function ChooseSheet(param){let{title,value:_value,options,callback}=param;const[value,setValue]=common.React.useState(_value);return common.React.createElement(ActionSheet,{title},options.map(function(x){return common.React.createElement(FormRow$2,{label:x.name,subLabel:x.description,trailing:x.iconComponent?x.iconComponent:x.icon&&common.React.createElement(common.ReactNative.Image,{source:x.icon,resizeMode:"cover",style:{width:24,height:24,tintColor:x.iconColor}}),leading:common.React.createElement(FormRow$2.Radio,{selected:x.value===value}),onPress:function(){setValue(x.value),callback(x.value)}})}))}const{FormCheckbox}=metro.find(function(x){return x?.FormCheckbox&&!x?.FormCardSection});function InlineCheckbox(param){let{label,initialValue,update}=param;const[value,setValue]=common.React.useState(initialValue);return update(value),common.React.createElement(common.ReactNative.Pressable,{accessibilityLabel:label,accessibilityRole:"checkbox",accessibilityState:{selected:value},onPress:function(){return setValue(!value)},style:{flexDirection:"row",alignItems:"center",gap:8,marginTop:12}},common.React.createElement(FormCheckbox,{checked:value}),common.React.createElement(Text,{variant:"text-md/normal",color:"TEXT_NORMAL"},label))}const AnimatedCircle=Reanimated.default.createAnimatedComponent(Svg.Circle);function ProgressCircle(param){let{radius,stroke,color,progress}=param;const{viewbox,circleRadius,circumference}=common.React.useMemo(function(){return{viewbox:(radius+stroke)*2,circleRadius:radius,circumference:2*Math.PI*(radius+stroke/2)}},[radius,stroke]),animatedProgress=Reanimated.useSharedValue(circumference),animatedStroke=Reanimated.useSharedValue(0);return common.React.useEffect(function(){animatedProgress.value=Reanimated.withTiming(circumference-progress*circumference,{duration:250}),animatedStroke.value=Reanimated.withTiming(progress!==0?stroke:0,{duration:250})},[progress,circumference,stroke]),common.React.createElement(Svg.Svg,{width:viewbox,height:viewbox,viewBox:`0 0 ${viewbox} ${viewbox}`,style:{position:"absolute",transform:[{rotate:"-90deg"},{translateY:stroke}]},pointerEvents:"none"},common.React.createElement(AnimatedCircle,{cx:"50%",cy:"50%",stroke:color,strokeWidth:animatedStroke,r:circleRadius,fill:"#0000",strokeDasharray:circumference,strokeLinecap:"round",strokeDashoffset:animatedProgress}))}const{FormRow:FormRow$1}=components.Forms;function IconpackRow(param){let{pack,onPress}=param;var _state_iconpack_hashes_pack_id;const styles=common.stylesheet.createThemedStyleSheet({headerTrailing:{flexDirection:"row",gap:15,alignItems:"center"},actions:{flexDirection:"row-reverse",alignItems:"center",gap:5}}),[packStatus,setPackStatus]=common.React.useState({installed:!1,outdated:!1,loading:!0}),[progressCnt,setProgressCnt]=common.React.useState(null);common.React.useEffect(function(){isPackInstalled(pack).then(function(x){return setPackStatus({installed:!!x,outdated:x==="outdated",loading:!1})})},[]);const size=(_state_iconpack_hashes_pack_id=state.iconpack.hashes[pack.id])===null||_state_iconpack_hashes_pack_id===void 0?void 0:_state_iconpack_hashes_pack_id.size;useState();const doInstall=function(){if(cancelRef.current)return cancelRef.current(),setPackStatus({installed:packStatus.installed,outdated:packStatus.outdated,loading:!1});if(!size||packStatus.loading)return;const willUninstall=packStatus.outdated?!1:packStatus.installed,cont=async function(){setPackStatus({installed:willUninstall,outdated:packStatus.outdated,loading:!0});const controller=new AbortController;willUninstall||(cancelRef.current=async function(){controller.abort(),packStatus.outdated||await uninstallIconpack(pack)});try{willUninstall?await uninstallIconpack(pack):await installIconpack(pack,controller.signal,setProgressCnt)}catch(e){return cancelRef.current=null,setProgressCnt(0),controller.signal.aborted||toasts.showToast(e.toString(),assets.getAssetIDByName("Small")),setPackStatus({installed:willUninstall,outdated:packStatus.outdated,loading:!1})}cancelRef.current=null,setProgressCnt(0),setPackStatus({installed:!willUninstall,outdated:!1,loading:!1})};let balls=vstorage.downloadIconpackModalDismissed;!balls&&!willUninstall?alerts.showConfirmationAlert({title:lang.format("alert.downloadpack.title",{}),children:common.React.createElement(common.React.Fragment,null,common.React.createElement(Text,{variant:"text-md/normal",color:"TEXT_NORMAL",style:{marginTop:8}},Lang.basicFormat(lang.format("alert.downloadpack.body",{iconpack:pack.name,space:formatBytes(size)}))),common.React.createElement(InlineCheckbox,{initialValue:vstorage.downloadIconpackModalDismissed,update:function(v){return balls=v},label:lang.format("alert.downloadpack.dontshowagain_toggle",{})})),confirmText:lang.format("alert.downloadpack.confirm",{}),cancelText:lang.format("alert.downloadpack.cancel",{}),onConfirm:function(){vstorage.downloadIconpackModalDismissed=balls,cont()}}):cont()},cancelRef=common.React.useRef(null);return common.React.useEffect(function(){return function(){var _cancelRef_current;return(_cancelRef_current=cancelRef.current)===null||_cancelRef_current===void 0?void 0:_cancelRef_current.call(cancelRef)}},[]),common.React.createElement(FormRow$1,{label:pack.name,subLabel:pack.description,onPress,leading:common.React.createElement(FormRow$1.Icon,{source:{uri:`${pack.load}images/native/main_tabs/Messages${pack.suffix}.png`}}),trailing:common.React.createElement(common.ReactNative.View,{style:styles.headerTrailing},vstorage.iconpackDownloading&&common.React.createElement(common.ReactNative.View,{style:styles.actions},progressCnt!==null&&common.React.createElement(ProgressCircle,{radius:16,stroke:3,color:"#fff",progress:progressCnt??null}),common.React.createElement(IconButton,{onPress:doInstall,loading:!packStatus||packStatus.loading,size:"sm",variant:packStatus&&packStatus.installed?packStatus.outdated?"primary":buttonVariantPolyfill().destructive:"secondary",disabled:!packStatus||!size||packStatus.loading&&!cancelRef.current,icon:packStatus&&assets.getAssetIDByName(packStatus.installed?packStatus.outdated?"GlobeEarthIcon":"TrashIcon":"DownloadIcon")})),common.React.createElement(FormRow$1.Radio,{selected:vstorage.iconpack.pack===pack.id}))})}const{FormRow,FormCheckboxRow}=components.Forms,tabs={iconpack:{title:function(){return lang.format("modal.config.iconpack.title",{})},render(){const styles=common.stylesheet.createThemedStyleSheet({previewBase:{width:60,height:60,backgroundColor:ui.semanticColors.BG_MOD_FAINT,borderRadius:8,justifyContent:"center",alignItems:"center",marginBottom:20},previewImage:{width:50,height:50}}),[_,forceUpdate]=common.React.useReducer(function(x){return~x},0);storage.useProxy(vstorage);const superSecretTimeout=common.React.useRef(null);return common.React.createElement(common.React.Fragment,null,common.React.createElement(common.ReactNative.View,{style:{marginHorizontal:16,marginTop:8}},common.React.createElement(RowButton,{label:lang.format("modal.config.iconpack.mode",{}),subLabel:lang.format(`modal.config.iconpack.mode.${vstorage.iconpack.mode}.desc`,{}),onPress:function(){return ActionSheet.open(ChooseSheet,{title:lang.format("modal.config.iconpack.mode",{}),value:vstorage.iconpack.mode,options:[exports.ConfigIconpackMode.Automatic,exports.ConfigIconpackMode.Manual,exports.ConfigIconpackMode.Disabled].map(function(e){return{name:lang.format(`modal.config.iconpack.mode.${e}`,{}),description:lang.format(`modal.config.iconpack.mode.${e}.desc`,{}),value:e}}),callback(v){vstorage.iconpack.mode=v}})},onPressIn:function(){return superSecretTimeout.current=setTimeout(function(){vstorage.iconpackDownloading||toasts.showToast("Yay!",assets.getAssetIDByName("SparklesIcon")),vstorage.iconpackDownloading=!vstorage.iconpackDownloading},3e3)},onPressOut:function(){return clearTimeout(superSecretTimeout.current)}})),vstorage.iconpack.mode===exports.ConfigIconpackMode.Manual&&common.React.createElement(common.React.Fragment,null,common.React.createElement(BetterTableRowGroup,{title:lang.format("modal.config.iconpack.choose",{})},state.iconpack.list.map(function(pack){return common.React.createElement(IconpackRow,{pack,onPress:function(){vstorage.iconpack.pack=pack.id,vstorage.iconpack.isCustom=!1,forceUpdate()}})}),common.React.createElement(FormRow,{label:lang.format("modal.config.iconpack.choose.custom",{}),trailing:common.React.createElement(FormRow.Radio,{selected:vstorage.iconpack.isCustom}),onPress:function(){vstorage.iconpack.isCustom=!0,delete vstorage.iconpack.pack,forceUpdate()}})),vstorage.iconpack.isCustom&&common.React.createElement(common.React.Fragment,null,common.React.createElement(BetterTableRowGroup,{title:lang.format("modal.config.iconpack.choose.custom",{}),padding:!0},common.React.createElement(common.ReactNative.View,{style:{paddingHorizontal:16,paddingTop:16}},common.React.createElement(common.ReactNative.View,{style:[{justifyContent:"center",alignItems:"center"},{gap:8}]},common.React.createElement(Text,{variant:"text-sm/semibold",color:"TEXT_SECONDARY"},lang.format("modal.config.iconpack.custom.preview",{})),common.React.createElement(common.ReactNative.View,{style:styles.previewBase},common.React.createElement(common.ReactNative.Image,{style:styles.previewImage,source:{uri:`${customUrl()}images/native/main_tabs/Messages${vstorage.iconpack.custom.suffix}.png`},resizeMode:"cover"}))),common.React.createElement(TextInput,{size:"md",value:vstorage.iconpack.custom.url,onChange:function(v){return vstorage.iconpack.custom.url=v},label:lang.format("modal.config.iconpack.custom.url",{}),description:lang.format("modal.config.iconpack.custom.url.desc",{}),placeholder:"https://example.com"}),common.React.createElement(common.ReactNative.View,{style:{height:8}}),common.React.createElement(TextInput,{size:"md",value:vstorage.iconpack.custom.suffix,onChange:function(v){return vstorage.iconpack.custom.suffix=v},label:lang.format("modal.config.iconpack.custom.suffix",{}),description:Lang.basicFormat(lang.format("modal.config.iconpack.custom.suffix.desc",{})),placeholder:"@2x"}))),common.React.createElement(BetterTableRowGroup,{nearby:!0},common.React.createElement(FormCheckboxRow,{label:lang.format("modal.config.iconpack.custom.config.bigger_status",{}),subLabel:Lang.basicFormat(lang.format("modal.config.iconpack.custom.config.bigger_status.desc",{})),leading:common.React.createElement(FormRow.Icon,{source:assets.getAssetIDByName("PencilIcon")}),selected:vstorage.iconpack.custom.config.biggerStatus,onPress:function(){return vstorage.iconpack.custom.config.biggerStatus=!vstorage.iconpack.custom.config.biggerStatus}})))),common.React.createElement(common.ReactNative.View,{style:{height:20}}))}}};function ConfigModal(){const state2=useSegmentedControlState({defaultIndex:0,items:Object.entries(tabs).map(function(param){let[id,data]=param;return{label:data.title(),id,page:data.render()}}),pageWidth:common.ReactNative.Dimensions.get("window").width});return storage.useProxy(vstorage),common.React.createElement(Modal,{mkey:"config-modal",title:lang.format("modal.config.title",{})},common.React.createElement(common.ReactNative.View,{style:{flex:0,marginTop:12}},common.React.createElement(Tabs,{state:state2})),common.React.createElement(common.ReactNative.ScrollView,{style:{flex:1}},common.React.createElement(SegmentedControlPages,{state:state2})))}const ListItem=function(param){let{state:state2,index:index2,children,trolley}=param;const trolleySupercalifragilisticexpialidocious=Reanimated.useSharedValue("0deg"),color=state2?"TEXT_POSITIVE":"TEXT_DANGER",styles=common.stylesheet.createThemedStyleSheet({icon:{tintColor:ui.semanticColors[color],width:16,height:16,marginTop:3},row:{flexDirection:"row",alignItems:"center",gap:4}});common.React.useEffect(function(){trolley&&(trolleySupercalifragilisticexpialidocious.value=Reanimated.withRepeat(Reanimated.withTiming("360deg",{duration:1e3,easing:Reanimated.Easing.linear}),-1,!1))},[]);const thing=Reanimated.FadeInLeft.duration(200).easing(Reanimated.Easing.out(Reanimated.Easing.ease)).delay(index2*25);return common.React.createElement(Reanimated.default.View,{style:[styles.row,{transform:[{rotateY:trolleySupercalifragilisticexpialidocious,rotateZ:trolleySupercalifragilisticexpialidocious},{perspective:100}]}],entering:thing,exiting:out},common.React.createElement(common.ReactNative.Image,{source:state2?assets.getAssetIDByName("CircleCheckIcon-primary"):assets.getAssetIDByName("CircleXIcon-primary"),style:styles.icon,resizeMode:"cover"}),common.React.createElement(Text,{variant:state2?"text-md/semibold":"text-md/medium",color},children))};let startTrollingTimeout,startTrollingCounter=0;const transition=Reanimated.LinearTransition.duration(100).easing(Reanimated.Easing.inOut(Reanimated.Easing.ease)),inUp=Reanimated.FadeInUp.duration(200).easing(Reanimated.Easing.out(Reanimated.Easing.ease)),out=Reanimated.FadeOut.duration(80).easing(Reanimated.Easing.ease);function settings(){useState();const trolley=common.React.useMemo(function(){return startTrollingTimeout||(startTrollingTimeout=setTimeout(function(){startTrollingCounter=0,startTrollingTimeout=null},5e3)),startTrollingCounter++,startTrollingCounter>=3?(clearTimeout(startTrollingTimeout),startTrollingCounter=0,!0):!1},[]),styles=common.stylesheet.createThemedStyleSheet({base:{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",paddingHorizontal:12,gap:15},container:{width:"100%",padding:12,backgroundColor:ui.semanticColors.CARD_PRIMARY_BG,borderColor:ui.semanticColors.BORDER_FAINT,borderWidth:1,borderRadius:16,gap:2,overflow:"hidden"},bottomButtons:{width:"100%",flexDirection:"row",alignItems:"center",gap:trolley?0:8},titleIcon:{tintColor:ui.semanticColors.TEXT_NORMAL,width:20,height:20},btnIcon:{tintColor:ui.semanticColors.REDESIGN_BUTTON_PRIMARY_TEXT,width:20,height:20,marginRight:4},btnIconSecdonary:{tintColor:ui.semanticColors.REDESIGN_BUTTON_SECONDARY_TEXT},row:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:2}}),trolleyRot=Reanimated.useSharedValue("0deg"),trolleyShake=Reanimated.useSharedValue("0deg"),trolleyClyde=Reanimated.useSharedValue("0deg");return common.React.useEffect(function(){trolley&&(trolleyRot.value=Reanimated.withRepeat(Reanimated.withTiming("360deg",{duration:600,easing:Reanimated.Easing.linear}),-1,!1),trolleyShake.value="-7deg",trolleyShake.value=Reanimated.withRepeat(Reanimated.withTiming("7deg",{duration:200}),-1,!0),trolleyClyde.value=Reanimated.withRepeat(Reanimated.withTiming("360deg",{duration:1500,easing:Reanimated.Easing.linear}),-1,!1))},[]),common.React.createElement(common.ReactNative.View,{style:styles.base},common.React.createElement(Reanimated.default.View,{style:[styles.container,{transform:[{rotate:trolleyShake}]}],layout:transition},state.loading?common.React.createElement(common.ReactNative.ActivityIndicator,{size:"large",style:{flex:1,marginVertical:30}}):common.React.createElement(common.React.Fragment,null,common.React.createElement(Reanimated.default.View,{style:styles.row,entering:inUp,exiting:out},common.React.createElement(Reanimated.default.Image,{source:trolley?assets.getAssetIDByName("clyde-avatar"):state.active?assets.getAssetIDByName("CircleCheckIcon-primary"):assets.getAssetIDByName("CircleXIcon-primary"),style:trolley?{width:100,height:100,borderRadius:25,transform:[{rotateY:trolleyClyde},{perspective:100}]}:styles.titleIcon,resizeMode:"cover"}),common.React.createElement(Text,{variant:"text-lg/semibold",color:"TEXT_NORMAL"},trolley?common.React.createElement(common.React.Fragment,null,"Themes+ is"," ",common.React.createElement(Text,{variant:"heading-xxl/bold",color:"TEXT_WARNING"},"AAAAAAAAAAAAAAAAAAAAAAAAAHHHH AAAAAAAAAAAA AAAAAAAGHHHHHHHHH")):Lang.basicFormat(lang.format("settings.header",{active:state.active})))),state.active?Object.values(exports.PatchType).sort(function(a,b){const isA=state.patches.includes(a),isB=state.patches.includes(b);return isA===isB?a<b?-1:a>b?1:0:isA?-1:isB?1:0}).map(function(x,i){return common.React.createElement(ListItem,{key:i,index:i,state:state.patches.includes(x),trolley},lang.format(`settings.patch.${x}`,{}))}):state.inactive.map(function(x,i){return common.React.createElement(ListItem,{key:i,index:i,state:!1,trolley},lang.format(`settings.inactive.${x}`,{}))}))),common.React.createElement(Reanimated.default.View,{style:[styles.bottomButtons,{transform:[{rotate:trolleyRot}]}],layout:transition},common.React.createElement(Button,{size:trolley?"sm":"md",variant:"primary",text:lang.format("settings.reload",{}),iconPosition:"start",icon:common.React.createElement(common.ReactNative.Image,{source:assets.getAssetIDByName("RetryIcon"),style:styles.btnIcon,resizeMode:"cover"}),onPress:function(){return!state.loading&&load()},loading:state.loading,style:{flex:trolley?.25:.5}}),common.React.createElement(Button,{size:trolley?"lg":"md",variant:"secondary",text:trolley?`${lang.format("modal.config.title",{}).toUpperCase()}!!!!!!!`:lang.format("modal.config.title",{}),iconPosition:"start",icon:common.React.createElement(common.ReactNative.Image,{source:assets.getAssetIDByName("SettingsIcon"),style:[styles.btnIcon,styles.btnIconSecdonary,trolley?{width:60,height:60}:null],resizeMode:"cover"}),onPress:function(){return openModal("config-modal",ConfigModal)},style:{flex:trolley?.75:.5}})),common.React.createElement(FloatingActionButton,{icon:assets.getAssetIDByName("CircleQuestionIcon-primary"),positionBottom:16,onPress:function(){return common.url.openURL("https://github.com/nexpid/ThemesPlus")}}))}exports.PatchType=void 0,function(PatchType2){PatchType2.Icons="icons",PatchType2.CustomIconOverlays="custom_icon_overlays",PatchType2.MentionLineColor="mention_line_color",PatchType2.Iconpack="iconpack"}(exports.PatchType||(exports.PatchType={})),exports.InactiveReason=void 0,function(InactiveReason2){InactiveReason2.NoTheme="no_theme",InactiveReason2.ThemesPlusUnsupported="themes_plus_unsupported",InactiveReason2.NoIconpacksList="no_iconpacks_list",InactiveReason2.NoIconpackConfig="no_iconpack_config",InactiveReason2.NoIconpackFiles="no_iconpack_files"}(exports.InactiveReason||(exports.InactiveReason={})),exports.ConfigIconpackMode=void 0,function(ConfigIconpackMode2){ConfigIconpackMode2.Automatic="automatic",ConfigIconpackMode2.Manual="manual",ConfigIconpackMode2.Disabled="disabled"}(exports.ConfigIconpackMode||(exports.ConfigIconpackMode={}));const vstorage=plugin.storage;exports.enabled=!1;const lang=new Lang("themes_plus");var index={onLoad:function(){vstorage.iconpack??(vstorage.iconpack={mode:"automatic",custom:{url:"https://raw.githubusercontent.com/acquitelol/rosiecord/master/Packs/Plumpy/",suffix:"@2x",config:{biggerStatus:!1}},isCustom:!1}),exports.enabled=!0;try{load()}catch(e){console.log("Themes+ failed to load whoopsies!!",e)}},onUnload:function(){exports.enabled=!1,lang.unload(),patches.forEach(function(x){return x()})},settings};return exports.default=index,exports.lang=lang,exports.vstorage=vstorage,Object.defineProperty(exports,"__esModule",{value:!0}),exports})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.toasts,vendetta.ui,vendetta.patcher,vendetta.storage,vendetta.ui.components,vendetta.utils,vendetta.ui.alerts);
